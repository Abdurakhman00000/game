function add_song_to_playlist(song_id,playlist_id){var url=base+extrabase+"/index.php?option=com_muscol&task=add_song_to_playlist&id="+playlist_id+"&song_id="+song_id;jQuery.ajax({url:url,dataType:'json',success:function(response,textStatus,jqXHR){var playablesong=response.playlistsong;var thenewitem=[response.content];jQuery('.results-module').map(function(index){var $module=jQuery('#'+this.id);if(playlist_id===parseInt($module.data('playlist'))){render_items(thenewitem,'#'+this.id);var module_id=$module.attr('list-id');jQuery('.noItemsInPlaylist[data-module="'+module_id+'"]').hide();}});if(jw_playlist_album)jw_playlist_album.push(playablesong);jwplayer().load(jw_playlist_album);notifyMessages(response.notifications);}});}
function dishighlight_item(position){jQuery('.song-item[data-isplayable]').removeClass('active playing paused');}
var currentItem=-1;var notifyAlbum=false;var notifyFirstSong=false;function onPlaylistItemListener(playListItem){if(currentItem==-1&&playListItem.index==0&&!notifyAlbum&&!notifyFirstSong){}
else if(currentItem==-1&&playListItem.index==0&&notifyAlbum){add_song_play_count(get_id_from_index(0));notify_song(playListItem);notifyAlbum=false;}else if(currentItem==-1&&playListItem.index==0&&notifyFirstSong){add_song_play_count(get_id_from_index(0));notify_song(playListItem);notifyFirstSong=false;}else if(playListItem.index!=currentItem){currentItem=playListItem.index;add_song_play_count(get_id_from_index(currentItem));notify_song(playListItem);}
dishighlight_item(playListItem.index);}
function onPlayListener(event){var firstOne=(currentItem===-1);var currentItemToHighlight=currentItem;if(firstOne)currentItemToHighlight=0;if(!new_songs_in_playlist&&!albumPlaying){jQuery("#song_search_results .song-item[data-isplayable]")[currentItemToHighlight].addClass('active playing').removeClass('paused');}else if(albumPlaying){jQuery('.playPauseAlbumBtn[data-id='+albumPlaying+']').removeClass('readyToPlay').removeClass('paused').addClass('playing');if(jQuery("#songs-album-"+albumPlaying).length){jQuery("#songs-album-"+albumPlaying+" .song-item[data-isplayable]")[currentItemToHighlight].addClass('active playing').removeClass('paused');}else{jQuery("#"+albumPlaying+" .song-item[data-isplayable]")[currentItemToHighlight].addClass('active playing').removeClass('paused');}}}
function onPauseListener(event){var firstOne=(currentItem===-1);var currentItemToHighlight=currentItem;if(firstOne)currentItemToHighlight=0;if(!albumPlaying)
jQuery("#song_search_results .song-item[data-isplayable]")[currentItemToHighlight].addClass('paused').removeClass('playing');else{jQuery('.playPauseAlbumBtn[data-id='+albumPlaying+']').removeClass('playing').addClass('paused');if(jQuery("#songs-album-"+albumPlaying).length){jQuery("#songs-album-"+albumPlaying+" .song-item[data-isplayable]")[currentItemToHighlight].addClass('paused').removeClass('playing');}else{jQuery("#"+albumPlaying+" .song-item[data-isplayable]")[currentItemToHighlight].addClass('paused').removeClass('playing');}}}
function add_song_play_count(song_id){var url=base+extrabase+"/index.php?option=com_muscol&task=add_song_play_count&id="+song_id;jQuery.ajax({url:url});}
function play_song_position(position){if(currentItem==position)jwplayer().play();else jwplayer().playlistItem(position);}
document.addEventListener('DOMContentLoaded',function(){if(Notification.permission!=="granted")
Notification.requestPermission();});function notify_song(song){if(desktopnotifications){if(!Notification){alert('Desktop notifications not available in your browser. Try Chromium.');return;}
if(Notification.permission!=="granted")
Notification.requestPermission();else{var notification=new Notification(song.item.title,{icon:song.item.image,body:song.item.description});setTimeout(function(){notification.close();},3000);notification.onclick=function(){};}}}